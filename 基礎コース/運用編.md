
# システム運⽤とは何か
## 運用とは
運⽤とはユーザーにサービスを提供し続けるためのすべての業務

## 必要な運用業務
### サービスが利用できない
サーバーダウン
サービスダウン
通信回線の問題

### レスポンスが遅い
⼤量アクセス
リソース不足

# AWSサービスを使ったシステム運⽤
## サーバー管理
### Systems Manager
AWSクラウドで実⾏されるアプリケーションとインフラストラクチャの管理に役⽴つ⼀連の機能を提供

### マネージドノード
Systems Managerで管理されている状態のサーバーをマネージドノードと呼ぶ
Systems Managerの⼀部の機能を利⽤するためには、サーバーをマネージドノードにする必要がある

#### リモート接続
#### コマンド一括実行
マネジメントコンソール（ブラウザ）からサーバーにシェルアクセスが可能
サーバーをプライベートネットワークに配置したまま利⽤可能
踏み台サーバーが不要

#### リモート接続
BashやPowershellのコマンドを複数のサーバーに対して⼀括実⾏可能
実⾏対象はインスタンス、タグ、リソースグループの単位で指定可能

#### 構成情報の管理
サーバーにインストールされているOS、アプリケーション等のインベントリ情報を収集
最短30分ごとにインベントリデータを定期的に収集し、データを最新状態に保つ

## 監視と通知
### CloudWatch
メトリクス(CPU 使⽤率、ディスク使⽤率等)、ログ、Synthetics 監視、アラーム等の機能を提供

### Simple Notification Service(SNS)
HTTP、Eメール、モバイルプッシュ通知、モバイルテキ
ストメッセージ(SMS)等のメッセージ配信が可能

### CloudWatch、SNSを使った監視・通知の例
Syntheticsが監視による結果がMetricsに送信される
Metricsに対してしきい値を設定し、しきい値を超えた場合にアラームを発⽣させる
CloudWatchがアラームをトリガーにして通知アクションを実⾏

### CloudWatch Agent
カスタムメトリクスやログの機能を利⽤するためには、サーバーにCloudWatch Agentの導⼊が必要

## バックアップ
### Backup
バックアップスケジュールの⾃動化やバックアップの保持、管理を⾏うフルマネージド型のバックアップサービス
サーバーまるごとのバックアップに使う
別リージョンにコピーすることも可能

### Simple Storage Service(S3)
どこからでも簡単に、お好みの量のデータを保存、取得できるオブジェクトストレージサービス
ファイルのバックアップに使う

# デモ
## Systems Manager
フリートマネージャーにEC2インスタンスがあると、Systems Managerにある機能が使える
1. Session Managerでサーバーに接続する<br>
接続したいインスタンスを選択<br>
2. Run Commandでコマンド一括実行<br>
コマンドドキュメントで一覧の処理がまとまっている<br>
AWS-RunShellScriptを選択し、コマンドのパラメータに実行したいコマンドを入力<br>
ターゲットはインスタンスを手動で選択するを選択<br>
Outputで実行結果を確認できる<br>
3. Inventoryの設定<br>
ターゲットはこのアカウントのすべてのマネージドインスタンスの選択を選択<br>

## CloudWatchとSNSの連携
1. CloudWatch Agentのインストールとセットアップ<br>
Run CommandのコマンドドキュメントでAWS-ConfigureAWSPackageを選択<br>
NameにAmazonCloudWatchAgentを入力し、ターゲットを指定して実行<br>
Run CommandのコマンドドキュメントでAmazonCloudWatch-ManageAgentを選択<br>
ターゲットを指定して実行<br>
2. Synthetics監視の設定<br>
Create canaryで、User blueprintを選択し、Heartbeat monitoringを選択
Nameは名前を入力し、Application or endpoint URLには監視したアプリのURLを入力<br>
ScheduleはRUn continuouslyを選択し、Everyを選択し、1を入力<br>
3. アラームの作成<br>
アラーム状態トリガーはアラーム状態を選択し、既存のSNSトピックを選択し、通知の送信先を選択<br>

## Backup
1. AWS Backupの設定<br>
新しいプランを立てるを選択<br>
プラン名を入力し、バックアップ頻度を毎日に選択<br>
保持期間は35日にする<br>
コピー先にコピーに、バックアップをとりたいリージョンを指定<br>
リソースの選択で特定のリソースタイプを含めるを選択し、特定のリソースタイプを選択でEC2を選択<br>








